var e,t=require("react"),n=(e=require("@use-it/event-listener"))&&"object"==typeof e&&"default"in e?e.default:e,r={},u=function(e,t,n){return r[e]||(r[e]={callbacks:[],value:n}),r[e].callbacks.push(t),{deregister:function(){var n=r[e].callbacks,u=n.indexOf(t);u>-1&&n.splice(u,1)},emit:function(n){r[e].value!==n&&(r[e].value=n,r[e].callbacks.forEach(function(e){t!==e&&e(n)}))}}};module.exports=function(e,r){if(void 0===r&&(r=global.localStorage),r){var c=function(e){return{get:function(t,n){var r=e.getItem(t),u="function"==typeof n?n():n;try{return null==r?u:JSON.parse(r)}catch(e){return console.log(e),u}},set:function(t,n){e.setItem(t,JSON.stringify(n))}}}(r);return function(r){return function(e,r,c){var a=c.get,i=c.set,o=t.useRef(null),f=t.useState(function(){return a(r,e)}),l=f[0],s=f[1];n("storage",function(e){if(e.key===r){var t=JSON.parse(e.newValue);l!==t&&s(t)}}),t.useEffect(function(){return o.current=u(r,s,e),function(){o.current.deregister()}},[]);var v=t.useCallback(function(e){var t="function"==typeof e?e(l):e;i(r,e),s(t),o.current.emit(e)},[l,i,r]);return[l,v]}(r,e,c)}}return t.useState};

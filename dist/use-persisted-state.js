var e,t=require("react"),n=(e=require("@use-it/event-listener"))&&"object"==typeof e&&"default"in e?e.default:e,r={},o=function(e,t,n){return r[e]||(r[e]={callbacks:[],value:n}),r[e].callbacks.push(t),{deregister:function(){var n=r[e].callbacks,o=n.indexOf(t);o>-1&&n.splice(o,1)},emit:function(n){r[e].value!==n&&(r[e].value=n,r[e].callbacks.forEach(function(e){t!==e&&e(n)}))}}};module.exports=function(e,r){if(void 0===r&&(r="undefined"!=typeof global&&global.localStorage?global.localStorage:"undefined"!=typeof globalThis&&globalThis.localStorage?globalThis.localStorage:"undefined"!=typeof window&&window.localStorage?window.localStorage:"undefined"!=typeof localStorage?localStorage:null),r){var a=function(e){return{get:function(t,n){var r=e.getItem(t),o="function"==typeof n?n():n;try{return null==r?o:JSON.parse(r)}catch(e){return console.error(e),o}},set:function(t,n){e.setItem(t,JSON.stringify(n))}}}(r);return function(r){return function(e,r,a){var l=a.get,u=a.set,c=t.useRef(null),i=t.useState(function(){return l(r,e)}),f=i[0],s=i[1];n("storage",function(e){if(e.key===r){var t=JSON.parse(e.newValue);f!==t&&s(t)}}),t.useEffect(function(){return c.current=o(r,s,e),function(){c.current.deregister()}},[e,r]);var g=t.useCallback(function(e){var t="function"==typeof e?e(f):e;u(r,t),s(t),c.current.emit(e)},[f,u,r]);return[f,g]}(r,e,a)}}return t.useState};
